# safe-udp

### 1 MTU（最大传输单元）

网络层定义的一个数据包的最大大小，**通常是1500字节**，指单个帧的最大大小，不包含以太帧头

### 2 TCP和MTU关系

- MSS（最大分片大小， Maximum Segment Size）：通常为1460字节（1500字节 - 20位IP头 - 20位TCP头）



### 3 UDP和MTU关系

- UDP数据报大小 <= 1500 - 20位IP头 - 8位UDP头 = 1472字节

### 

### 4 safe-udp头部格式

![image-20240826190942224](C:\Users\z1002\AppData\Roaming\Typora\typora-user-images\image-20240826190942224.png)

头部总长度：12bytes

- 序列号：4字节，解决乱序问题
- 确认号：4字节，解决丢包问题
- Ack Flag：1字节
- Fin Flag：1字节
- 数据长度：2字节

![image-20240826190848347](C:\Users\z1002\AppData\Roaming\Typora\typora-user-images\image-20240826190848347.png)

safe-udp数据报大小 = 1472 - 12 = 1460bytes

### 5 序列化反序列化接口

#### 5.1 小端序和大端序

- 小端（Little-endian）
  - 低地址存放地低位字节，**高地址存放高位字节**
  - 32位整数0x12345678在小端内存中存储顺序：78 56 34 12
- 大端（Big-endian）
  - **高地址存放低位字节**，低地址存放高位字节
  - 32位整数0x12345678在大端内存中存储顺序：12 34 56 78

主机字节大多是小端，网络字节是大端

不同的计算机体系结构和处理器可能采用不同的存储方式。这种差异主要源于历史原因和设计考虑。一些处理器采用小端存储是因为它**更符合硬件设计的便利性**，例如在进行**数据的逐字节**处理时较为方便。而大端存储则在某些**网络通信协议和特定的应用场景**中具有优势，因为它可以使数据的**高位字节首先被处理，符合人类的阅读习惯**。

#### 5.2 